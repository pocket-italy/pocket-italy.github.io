import{c as h}from"./chunk-3BCLD6MB.js";import{c as b,d as u,e as f}from"./chunk-WODP3O2L.js";import"./chunk-VG5VR7ER.js";import{g as d}from"./chunk-SC6RD57Z.js";import{Ka as r,Y as n,Ya as p,Za as c,_a as l,d as v,mb as m}from"./chunk-TCK2NVJ2.js";var i=v(b());i.Icon.Default.imagePath="assets/leaflet/";var w=(()=>{let o=class o{constructor(e,t){this.service=e,this.router=t,this.markers=[],this.report=[]}initMarker(){let e=[];for(let t of this.report){let a=i.marker([t.lat,t.long],{icon:t.outcome==="positive"?f:u});a.bindPopup('<div class="flex flex-col justify-center items-center"><p class="w-fit text-lg text-white">Segnalazione n.'+t.reportNumber+'</p><button class="detail rounded-full bg-pocket_yellow px-10 py-1 text-lg font-normal leading-8 text-black shadow-sm hover:bg-pocket_yellow_p-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-pocket_yellow_p-600"> Visualizza </button></div>',{className:"popupCustom"}).on("popupopen",g=>{g.target.getPopup().getElement().querySelector(".detail").addEventListener("click",()=>{this.openDetail(t)})}),e.push(a)}this.markers=e}openDetail(e){this.router.navigateByUrl("zecca/map/"+e.id)}ngAfterViewInit(){this.service.getMapReports().subscribe(e=>{this.report=e,this.initMarker(),this.initializeMap(),this.addMarkers(),this.centerMap()})}initializeMap(){let e="https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png";this.map=i.map("map"),i.tileLayer(e).addTo(this.map)}addMarkers(){this.markers.forEach(e=>e.addTo(this.map))}centerMap(){let e=i.latLngBounds(this.markers.map(t=>t.getLatLng()));this.map.fitBounds(e)}};o.\u0275fac=function(t){return new(t||o)(r(h),r(d))},o.\u0275cmp=n({type:o,selectors:[["app-zecca-map"]],standalone:!0,features:[m],decls:2,vars:0,consts:[[1,"map-container"],["id","map"]],template:function(t,a){t&1&&(p(0,"div",0),l(1,"div",1),c())},styles:["#map[_ngcontent-%COMP%]{height:100vh}.map-container[_ngcontent-%COMP%]{border:1px solid black}"]});let s=o;return s})();export{w as ZeccaMapComponent};
